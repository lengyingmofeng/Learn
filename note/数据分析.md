

# 数据分析

## 1. matplotlib



### 折线图：plot

#### 简单绘图

绘制折线图首先传递x，y轴的值，调用plot方法把x，y传递进去，使用show展示图形就可以了

```python
import numpy as np
import matplotlib.pyplot as plt
 
x = np.linspace(-10, 10, 100)
y = x**2

# 绘图
plt.plot(x,y)
# 展示图形
plt.show()
```

一张图形就展示出来了

![image-20211018120952267](https://i.loli.net/2021/10/18/G3iDu7pTxyU51AC.png)

 通过上面图我们发现，有很多的问题，比如说x轴表示什么，y轴表示什么，绘图如何保存到本地，怎么设置图片大小，绘制标签线条样式等等。下面我们讲一一解答

#### 图纸设置大小

我们在绘图的时候可以给图纸设置大小

```python
from matplotlib import pyplot as plt

x = range(2, 26, 2)
y = [15, 13, 5, 8, 4, 6, 5, 9, 13, 9, 10, 16]
# figsize图形图标的意思，在这里指的就是我画的图
# 在图形模糊的时候可以传入dpi参数，让图片更加清晰
plt.figure(figsize=(20, 8), dpi=80)
# 绘图
plt.plot(x, y)
# 保存
plt.savefig("./plt.jpg")
# 展示图形
plt.show()

```

![image-20211018121032888](https://i.loli.net/2021/10/18/QK75JWu2xej1XGU.png)



#### 设置刻度范围

使用pyplot模块的`xlim()`和`ylim()`函数分别可以设置或获取x轴和y轴的刻度范围。 



```python
xlim(left=None, right=None,  emit=True, auto=False, *, xmin=None, xmax=None)  
```



- left:表示x轴刻度取值区间的**左位数**
- right:表示x轴刻度取值范围区间的**右位数**
- emit:表示是否通知限制变化的观察者，默认为True
- auto:表示是否允许自动缩放x轴，默认为True

此外，Axes对象可以使用set_xlim()或set_ylim()方法设置x轴或y轴的刻度范围。 



#### 设置刻度标签

通过上图我们发现这个x轴刻度不是我们想要的，这个刻度过于稀疏，我们想要紧凑一些，可以设置一下x轴的刻度使用pyplot模块的`xticks()`或`yticks()`函数可以设置x轴或y轴的刻度线位置和刻度标签。 

```python
xticks(ticks=None, labels=None, **kwargs)  
```



- ticks：表示**刻度显示的位置列表**，该参数可以设置为空列表，以此禁用x轴的刻度
- labels: 表示指定位置刻度的**标签列表**

此外，Axes对象可以使用set_xticks()或set_yticks()方法设置x轴或y轴的刻度线位置，使用set_xticklabels()或set_yticklabels()方法设置x轴或y轴的刻度标签。  

```python
import numpy as np
from matplotlib import pyplot as plt

x = range(2, 26, 2)
y = [15, 13, 5, 8, 4, 6, 5, 9, 13, 9, 10, 16]
# 设置图片大小
plt.figure(figsize=(20, 8), dpi=80)
# 绘图
plt.plot(x, y)

# 设置刻度
plt.xticks(x)
plt.yticks(range(1, 26, 1))
# 保存
plt.savefig("./plt.jpg")
# 展示图形
plt.show()
```



![image-20211018122241303](https://i.loli.net/2021/10/18/asphBX1YMyUdGqe.png)

觉得刻度间隔过于紧凑，可以使用切片的方式让刻度松弛一些

#### 设置中文

##### 方式一 FontProperties

```python
import matplotlib.pyplot as plt
from matplotlib.font_manager import FontProperties  # 步骤一

# ...

font = FontProperties(fname=r"c:\windows\fonts\simsun.ttc", size=14)  # 步骤二
plt.xlabel("x轴", fontproperties=font) # 步骤三
plt.ylabel("y轴", fontproperties=font)
plt.title("标题", fontproperties=font)
plt.show()
```

总的来说，很丑陋

##### 方式二 fontproperties

```python
import matplotlib.pyplot as plt

# ...

plt.xlabel("x轴")
plt.ylabel("y轴", fontproperties="SimSun") # 步骤一    （宋体）
plt.title("标题", fontproperties="SimHei") #          （黑体）
plt.show()
```

灵活，另一个优点：不污染全局字体设置



##### 方式三 rcParams

```python
import matplotlib.pyplot as plt

plt.rcParams['font.sans-serif'] = ['SimHei'] # 步骤一（替换sans-serif字体）
plt.rcParams['axes.unicode_minus'] = False   # 步骤二（解决坐标轴负数的负号显示问题）
#...

plt.xlabel("x轴")
plt.ylabel("y轴")
plt.title("标题")
plt.show()
```

简洁的用法。缺点：污染全局字体设置。（所以需要第二步骤）



##### 方式四 rc

```python
import matplotlib.pyplot as plt

font = {'family' : 'SimHei',
        'weight' : 'bold',
        'size'   : '16'}
plt.rc('font', **font)               # 步骤一（设置字体的更多属性）
plt.rc('axes', unicode_minus=False)  # 步骤二（解决坐标轴负数的负号显示问题）

#...

plt.xlabel("x轴")
plt.ylabel("y轴")
plt.title("标题")
plt.show()
```



灵活的用法。缺点：影响全局字体（所以需要第二步骤）



##### 总结：

方式二用时才设置，且不会污染全局字体设置，**更灵活**

方式三、方式四不需要对字体路径硬编码，而且一次设置，多次使用，**更方便。**



#### 添加图例

什么是图例，为什么要添加，我们通过下面这个案例来进行讲解。

我们想要绘制一份自己和同桌异性朋友的折线图

```python
from matplotlib import pyplot as plt
from matplotlib.font_manager import FontProperties

# 设置字体
font = FontProperties(fname=r"c:\windows\fonts\STSONG.TTF", size=10)

x = [i for i in range(11, 31)]  # 表示年龄
y = [0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 1, 1, 1, 1]  # 表示自己异性朋友个数
z = [0, 0, 1, 1, 2, 2, 3, 3, 2, 3, 2, 3, 4, 3, 4, 3, 3, 2, 1, 1]  # 表示同桌异性朋友个数
number = range(0, 7)
# 图纸设置大小
plt.figure(figsize=(10, 8), dpi=100)

# 绘图
plt.plot(x, y)
plt.plot(x, z)
# 设置x刻度
x_tick_labels = ["{}岁".format(i) for i in x]
plt.xticks(x, x_tick_labels, fontproperties=font)

# 设置y轴刻度
plt.yticks(number)

# 展示
plt.show()
```

![image-20211108160025533](https://i.loli.net/2021/11/08/UWvVNn5hCmLBJZa.png)



我们画出来的图就只有二条线，显得很单调而且也表示不清楚是什么，用户看到这个图就只是一条曲折线，并不知道这条线代表什么。这时候我们可以添加图例来给线进行一个注释，从而方便用户理解。

语法：

```python
legend(handles, labels, loc, bbox_to_anchor, ncol, title, shadow, fancybox, *args, **kwargs) 
```



- handles:表示由**图形标识构成的列表**
- labels:表示由**图例项构成的列表**
- loc:用于控制图例在图表中的位置
- ncol:表示**图例的列数**，默认为1
- title:表示**图例的标签**，默认为None
- shadow：表示是否在图例后面**显示阴影**，默认为None
- fancybox:表示是否为图例设置圆角边框，默认为None



````python
from matplotlib import pyplot as plt
from matplotlib.font_manager import FontProperties

# 设置字体
font = FontProperties(fname=r"c:\windows\fonts\STSONG.TTF", size=10)

x = [i for i in range(11, 31)]  # 表示年龄
y = [0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 1, 1, 1, 1]  # 表示自己异性朋友个数
z = [0, 0, 1, 1, 2, 2, 3, 3, 2, 3, 2, 3, 4, 3, 4, 3, 3, 2, 1, 1]  # 表示同桌异性朋友个数
number = range(0, 7)
# 图纸设置大小
plt.figure(figsize=(10, 8), dpi=100)

# 绘图
plt.plot(x, y, label='自己')
plt.plot(x, z, label='同桌')
# 设置x刻度
x_tick_labels = ["{}岁".format(i) for i in x]
plt.xticks(x, x_tick_labels, fontproperties=font)

# 设置y轴刻度
plt.yticks(number)
plt.legend()
# 展示
plt.show()


# 或者写成这样
from matplotlib import pyplot as plt
from matplotlib.font_manager import FontProperties

# 设置字体
font = FontProperties(fname=r"c:\windows\fonts\STSONG.TTF", size=10)

x = [i for i in range(11, 31)]  # 表示年龄
y = [0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 1, 1, 1, 1]  # 表示自己异性朋友个数
z = [0, 0, 1, 1, 2, 2, 3, 3, 2, 3, 2, 3, 4, 3, 4, 3, 3, 2, 1, 1]  # 表示同桌异性朋友个数
number = range(0, 7)
# 图纸设置大小
plt.figure(figsize=(10, 8), dpi=100)

# 绘图
lines = plt.plot(x, y, x, z)
# 设置x刻度
x_tick_labels = ["{}岁".format(i) for i in x]
plt.xticks(x, x_tick_labels, fontproperties=font)

# 设置y轴刻度
plt.yticks(number)
plt.legend(lines, ["自己", "同桌"], shadow=True, fancybox=True, prop=font)
# 展示
plt.show()
````

![image-20211108164824304](https://i.loli.net/2021/11/08/rI5SkcdMPQfG6xJ.png)





我们会发现图例上显示不了中文，如果我们要设置中文，则要在legend里面传递一个位置参数

```python
from matplotlib import pyplot as plt
from matplotlib.font_manager import FontProperties

# 设置字体
font = FontProperties(fname=r"c:\windows\fonts\STSONG.TTF", size=10)

x = [i for i in range(11, 31)]  # 表示年龄
y = [0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 1, 1, 1, 1]  # 表示自己异性朋友个数
z = [0, 0, 1, 1, 2, 2, 3, 3, 2, 3, 2, 3, 4, 3, 4, 3, 3, 2, 1, 1]  # 表示同桌异性朋友个数
number = range(0, 7)
# 图纸设置大小
plt.figure(figsize=(10, 8), dpi=100)

# 绘图
plt.plot(x, y, label='自己')
plt.plot(x, z, label='同桌')
# 设置x刻度
x_tick_labels = ["{}岁".format(i) for i in x]
plt.xticks(x, x_tick_labels, fontproperties=font)

# 设置y轴刻度
plt.yticks(number)

# 添加图例，
plt.legend(prop=font)

# 展示
plt.show()
```

![image-20211108165038040](https://i.loli.net/2021/11/08/j8hIg1TUzCEcnuk.png)



如果我们不想要他显示在右上方使用loc设置在其他地方参数如下

`plt.legend(loc='lower left')`

| 参数              | 表示           |
| ----------------- | -------------- |
| 0：best           | 默认显示右上方 |
| 1: ‘upper right'  | 右上方         |
| 2: ‘upper left'   | 左上方         |
| 3: ‘lower left'   | 左下方         |
| 4: ‘lower right'  | 右下方         |
| 5: ‘right'        | 右边           |
| 6: ‘center left'  | 左中间         |
| 7: ‘center right' | 右中间         |
| 8: ‘lower center' | 下中间         |
| 9: ‘upper center' | 上中间         |
| 10: ‘center'      | 中间           |



#### 设置线条格式

如果我们想要改变线条颜色不想一条线是橙色一条线是蓝色，可以在plot里面设置

| 参数      | 表示     |
| --------- | -------- |
| color     | 颜色     |
| linestyle | 线条风格 |
| linewidth | 线条粗细 |
| alpha     | 透明度   |



| 颜色符号      | 风格符号                   | 透明度 |
| ------------- | -------------------------- | ------ |
| r: 红色       | `-`：实线                  | 0-1    |
| g：绿色       | `--`：虚线.破折线          |        |
| b：蓝色       | `-.`：点划线               |        |
| w: 白色       | `：`: 点虚线，虚线         |        |
| c: 青色       | `''`: 留空或者空格，无线条 |        |
| m：洋红       |                            |        |
| #00000 16进制 |                            |        |



```python
from matplotlib import pyplot as plt
from matplotlib.font_manager import FontProperties

# 设置字体
font = FontProperties(fname=r"c:\windows\fonts\STSONG.TTF", size=10)

x = [i for i in range(11, 31)]  # 表示年龄
y = [0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 1, 1, 1, 1]  # 表示自己异性朋友个数
z = [0, 0, 1, 1, 2, 2, 3, 3, 2, 3, 2, 3, 4, 3, 4, 3, 3, 2, 1, 1]  # 表示同桌异性朋友个数
number = range(0, 7)
# 图纸设置大小
plt.figure(figsize=(10, 8), dpi=100)

# 绘图
plt.plot(x, y, label='自己', color='skyblue', linestyle='-.')
plt.plot(x, z, label='同桌', color='red', linestyle='--')

# 设置x刻度
x_tick_labels = ["{}岁".format(i) for i in x]
plt.xticks(x, x_tick_labels, fontproperties=font)

# 设置y轴刻度
plt.yticks(number)

# 添加图例，
plt.legend(prop=font, loc="upper center")

# 展示
plt.show()
```





![image-20211108170943661](https://i.loli.net/2021/11/08/DZm2PCM4gpnceB8.png)



#### 添加网格

使用pyplot模块的grid()函数可以显示图表中的网格。

语法：

```python
grid(b=None, which='major', axis='both', **kwargs) 
```



- b:表示是否显示网格
- which：表示显示网格类型，默认为major
- axis：表示显示哪个方向的网格，默认为both
- linewidth或lw：网格宽度

```python
# linestyle设置网格线条样式
plt.grid(alpha=0.4, linestyle='-.')
```



**若坐标轴没有刻度，则将无法显示网格。** 



#### 添加参考线

使用pyplot模块的axhline()函数可以为图表添加水平参考线。

````python
axhline(y=0, xmin=0, xmax=1, linestyle='-', **kwargs) 
````



- y:表示**水平参考线的纵坐标**
- xmin：表示水平参考线的**起始位置**，默认为0
- ymax：表示水平参考线的**终止位置**，默认为1
- linestyle：表示水平参考线的类型，默认为实线

添加参考线

```python
plt.axvline(x=0, linestyle='--')
plt.axhline(y=0, linestyle='--')
```

#### 添加参考区域

使用pyplot模块的axhspan()函数可以为图表添加水平参考区域。

```python
axhspan(ymin, ymax, xmin=0, xmax=1, **kwargs)
```



- ymin:表示**水平跨度的下限**，以数据为单位
- ymax:表示水平跨度的上限，以数据为单位
- xmin:表示垂直跨度的下限，以轴为单位，默认为0
- xmax:表示垂直跨度的上限，以轴为单位，默认为1



使用pyplot模块的axvspan()函数可以为图表添加垂直参考区域

```python
axvspan(xmin, xmax, ymin=0, ymax=1, **kwargs) 
```

 

- xmin:表示垂直跨度的下限
- xmax:表示垂直跨度的上限

添加垂直参考区域与水平参考区域

```python
plt.axvspan(xmin=0.5, xmax=2.0, alpha=0.3)
plt.axhspan(ymin=0.5, ymax=1.0, alpha=0.3) 
```



#### 添加指向型注释文本

使用pyplot模块的`annotate()`函数可以为图表添加指向型注释文本。

语法：

```python
annotate(s, xy, *args, **kwargs) 
```



- s:表示注释文本的内容
- xy：表示被注释的点的坐标位置，接收元组（x,y)
- xytext:表示注释文本所在的坐标位置，接收元组（x, y)
- arrowprops: 表示指示箭头的属性字典
- bbox：表示注释文本的边框属性字典



•arrowprops 参数接收一个包含若干键的字典，通过向字典中添加键值对以控制箭头的显示。常见的控制箭头的键包括width、headwidth、headlength、shrink、arrowstyle等。

•键arrowstyle代表箭头的类型，该键对应的值及其类型如下图所示。



![](https://s2.loli.net/2021/12/14/bcBl5aHrIzJ8T9g.png)



```python
# 添加指向型注释文本
plt.annotate("最小值", xy=(-np.pi / 2, -1.0), xytext=(-(np.pi / 2), -0.5), arrowprops=dict(arrowstyle="->")) 
```



#### 添加无指向型注释文本

使用pyplot模块的text()函数可以为图表添加无指向型注释文本。

语法：

```python
text(x, y, s, fontdict=None, withdash=<deprecated parameter>, **kwargs) 
```



- x, y:表示**注释文本的位置。**
- s:表示注释**文本的内容。**
- `horizontalalignment`或`ha`：表示水平对齐的方式，可以取值为'center'、'right'或 'left'。
- `verticalalignment`或`va：表示垂直对齐的方式，可以取值为'center'、'top'、'bottom'、'baseline'或'center_baseline'



### 添加自定义样式的表格

使用pyplot模块的table()函数可以为图表添加数据表格。

```python
table(cellText=None, cellColours=None, cellLoc='right', colWidths=None, …, **kwargs) 
```



- rowLoc：表示**行标题的对齐方式。**
- colLabels：表示**列标题的文本。**
- colColours：表示列标题所在单元格的背景颜色。
- colLoc：表示列标题的对齐方式。
- loc：表示表格对于绘图区域的对齐方式。



```python
# 添加表格
plt.table(cellText=[[6, 6, 6], [8, 8, 8]], colWidths=[0.1] * 3, rowLabels=['第1行', '第2行'], colLabels=['第1列', '第2列', '第3列'], loc='lower right')  
```



### 散点图scatter

散点图需要两个参数x,y , 但此时，x不是表示x轴的刻度，而是每个点的横轴坐标！

```python 
import numpy as np
import matplotlib.pyplot as plt
 
N = 1000
x = np.random.randn(N)
y = np.random.randn(N)
 
plt.scatter(x, y)
 
plt.show()
```



scatter还有许多参数用来调整图形的外观，常用的参数如下：

| 参数   | 表示                      |
| ------ | ------------------------- |
| s      | 标记大小                  |
| c      | 图形颜色，默认为蓝色      |
| marker | 标记形式，默认为小圆圈`o` |
| alpha  | 透明度                    |



```python

import matplotlib.pyplot as plt  
import numpy as np             
 
x = np.random.randn(100)
y = np.random.randn(100)
'''设置每一个点的颜色随机生成'''
color = np.random.random(300).reshape((100,3))  # 一千行三列
'''设置每一个点的大小随机生成'''
size = np.random.randint(0,100,100)
plt.scatter(x,y,color = color,s=size,marker='*')
plt.show()
```





### 条形图：bar

```python
import matplotlib.pyplot as plt

y = [4, 6, 2, 1, 6]
x = ["EDG", "RNG", "WE", "IG", "OMG"]

plt.figure(figsize=(10, 5), dpi=80)
plt.bar(x, y, width=0.6)

plt.show()
```



绘制多个图形，让图形不在同一水平线上

```python
import numpy as np
import matplotlib.pyplot as plt
from matplotlib.font_manager import FontProperties
y = [4, 6, 2, 1, 6]
x = ["EDG", "RNG", "WE", "IG", "OMG"]

font = FontProperties(fname=r"C:\Windows\Fonts\simsun.ttc")

# 给条形图设置一个宽度
width = 0.3
plt.figure(figsize=(15, 7), dpi=80)
plt.bar(x, y, width=width, label="春季赛")
"""
[i + 0.3 for i in range(len(x))] 改变x轴绘图的坐标让图形不在同一个坐标上
np.random.randint(1, 6, 5) 随机生成1~6五个数字

"""
plt.bar([i + 0.3 for i in range(len(x))], np.random.randint(1, 6, 5), width=width, label="夏季赛")
# 改变x轴的刻度让标题在两个图形中间
plt.xticks([i + 0.15 for i in range(len(x))], x)
plt.legend(loc=1, prop=font)

plt.show()
```

![image-20211109123351821](https://i.loli.net/2021/11/09/AmCofGq8J4PRpwX.png)

横行条形图

```python
import numpy as np
import matplotlib.pyplot as plt
from matplotlib.font_manager import FontProperties
y = [4, 6, 2, 1, 6]
x = ["EDG", "RNG", "WE", "IG", "OMG"]

font = FontProperties(fname=r"C:\Windows\Fonts\simsun.ttc")

# 给条形图设置一个height
height = 0.3
plt.figure(figsize=(15, 7), dpi=80)
plt.barh(x, y, height=height, label="春季赛")
"""
[i + 0.3 for i in range(len(x))] 改变x轴绘图的坐标让图形不在同一个坐标上
np.random.randint(1, 6, 5) 随机生成1~6五个数字

"""
plt.barh([i + 0.3 for i in range(len(x))], np.random.randint(1, 6, 5), height=height, label="夏季赛")
# 改变x轴的刻度让标题在两个图形中间
plt.xticks([i + 0.15 for i in range(len(x))], x)
plt.legend(loc=1, prop=font)

plt.show()
```



![image-20211109123301831](https://i.loli.net/2021/11/09/Z1dqxc3Iv6sVEYT.png)

### 直方图：hist

```python
import matplotlib.pyplot as plt
import numpy as np
import matplotlib

# 设置matplotlib正常显示中文和负号
matplotlib.rcParams['font.sans-serif'] = ['SimHei']  # 用黑体显示中文
matplotlib.rcParams['axes.unicode_minus'] = False  # 正常显示负号
# 随机生成（10000,）服从正态分布的数据
data = np.random.randn(10000)
"""
绘制直方图
data:必选参数，绘图数据
bins:直方图的长条形数目，可选项，默认为10
density:是否将得到的直方图向量归一化，可选项，默认为False，代表不归一化，显示频数。density=True，表示归一化，显示频率。
facecolor:长条形的颜色
edgecolor:长条形边框的颜色
alpha:透明度
"""
plt.hist(data, bins=40, density=True, facecolor="blue", edgecolor="black", alpha=0.7)
# 显示横轴标签
plt.xlabel("区间")
# 显示纵轴标签
plt.ylabel("频数/频率")
# 显示图标题
plt.title("频数/频率分布直方图")
plt.show()

```



### 饼图：pie

- 注意显示的百分比的位数
- plt.pie(x, labels=,autopct=,colors)
  - x:数量，自动算百分比
  - labels:每部分名称
  - autopct:占比显示指定%1.2f%%
  - colors:每部分颜色

```python

import numpy as np
import matplotlib.pyplot as plt
 
labels = "A", "B", "C", "D"
fracs = [15, 29, 89, 54]
explode = [0, 0.1, 0, 0] #设置突出显示的参数部分，此处表示只有B突出显示
 
plt.axes(aspect=1) #使坐标轴横纵等距
 
#autopct为在饼状图内部显示出相应的数据（百分比）
plt.pie(x=fracs, labels=labels, autopct="%.0f%%", explode=explode)
 
plt.show()
```



```python
import matplotlib.pyplot as plt
from matplotlib.font_manager import FontProperties
plt.rcParams['font.sans-serif'] = ['SimHei'] # 步骤一（替换sans-serif字体）
plt.rcParams['axes.unicode_minus'] = False   # 步骤二（解决坐标轴负数的负号显示问题）

# 1）准备数据
movie_name = ['雷神3：诸神黄昏','正义联盟','东方快车谋杀案','寻梦环游记','全球风暴','降魔传','追捕','七十七天','密战','狂兽','其它']

place_count = [60605,54546,45819,28243,13270,9945,7679,6799,6101,4621,20105]

# 2）创建画布
plt.figure(figsize=(20, 8), dpi=100)

# 3）绘制饼图
plt.pie(place_count, labels=movie_name, autopct="%1.2f%%")

# 显示图例
plt.legend(prop="SimHei")

# 添加标题
plt.title("电影排片占比")

# 4）显示图像
plt.show()
```





### 雷达图：polar

#### 简介

- 雷达图，又可称为戴布垃图(Radar Chart)、蜘蛛网图(spider Chart),可以很好的刻画出某些指标的横向或纵向的对比关系
- 雷达图常用于多项指标的全面分析，比如HR想要比较两个应聘者的综合素质，用雷达图分明画出来，就可以直接直观的比较
- Python中用matplotlib模块绘制雷达图需要用到极坐标系

#### 极坐标系

**先了解一下什么是极坐标**

极点：以圆的中心作为极点`O`，

极轴：以0°的方向引一条射线极轴`Ox`,

极径：选定一个长度单位`r`

极角：以`Ox`正方向开始计算角度`θ`（通常取逆时针方向）

极坐标：以极点`O`作为圆心，以极昼`Ox`的方向作为起点，以极径`r`作为半径，画一个以极角`θ`的扇形，最终圆规脚定的位置就是极坐标`M`

![img](https://i.loli.net/2021/12/03/1btixFLQBHJKfYz.png)



#### Polar函数

`ploar(theta, r, **kwargs``)`

主要参数

- theta: 指极角θ
- r: 指极劲

````python
import matplotlib.pyplot as plt
import numpy as np

"""
0.25*np.pi：极角
20:以20作为半径
lw=2:表示极坐标图案的宽度
ro:绘制的极坐标图形为红色圆点 
ylim(0,100):设置极轴的范围
"""
plt.polar(0.25*np.pi,20,"ro",lw=2)
plt.ylim(0,100)
plt.show()
````



![image-20211203091749638](https://i.loli.net/2021/12/03/NO1apet7GmEXscg.png)



- 如果绘制多个极角和极轴时：

```python
from matplotlib import pyplot as plt
import numpy as np
theta = np.array([0.25, 0.5, 0.7, 0.67, 0.91])
r = [10, 45, 30, 70, 47]
# lw -> linewidth
plt.polar(theta * np.pi, r, 'ro', lw=2)
plt.ylim(0, 100)
plt.show()

```



![image-20211209215711565](https://s2.loli.net/2021/12/09/FORdq4hQEDXiut1.png)



- 绘制完极坐标点后，把每个点用线连起来，就是雷达图了
- 只需要把图形绘制样式修改为`ro-`即可

```python

'''4.链接极坐标点'''
import numpy as np
import matplotlib.pyplot as plt
theta = np.array([0.25,0.5,0.75,1,1.25,1.5,1.75,2])
r = [75,60,50,70,50,85,45,70]
plt.polar(theta*np.pi, r, 'ro-', lw=2)
plt.ylim(0,100)
plt.show()

```



![image-20211209220118246](https://s2.loli.net/2021/12/09/eYbrvIVcjZLN8Gp.png)



- 闭合曲线：多构造一个极坐标点，和第一个点重叠

````python
import numpy as np
import matplotlib.pyplot as plt

# 只需在末尾添加一个和起始点重合的点
theta = np.array([0.25, 0.5, 0.75, 1, 1.25, 1.5, 1.75, 2, 0.25])
r = [75, 60, 50, 70, 50, 85, 45, 70, 75]
plt.polar(theta * np.pi, r, 'ro-', lw=2)
plt.ylim(0, 100)
plt.show()
````



![img](https://s2.loli.net/2021/12/09/Skg3mChUvxA4VdJ.png)



- fill()函数填充雷达图

````python
'''6.填充颜色'''
import numpy as np
import matplotlib.pyplot as plt

# 只需在末尾添加一个和起始点重合的点
theta = np.array([0.25, 0.5, 0.75, 1, 1.25, 1.5, 1.75, 2, 0.25])
r = [75, 60, 50, 70, 50, 85, 45, 70, 75]
plt.polar(theta * np.pi, r, 'ro-', lw=2)
plt.fill(theta * np.pi, r, facecolor='r', alpha=0.5)  # 填充
plt.ylim(0, 100)
plt.show()
````



![img](https://s2.loli.net/2021/12/09/458y1VxibWNUstC.png)



- 绘制成绩雷达图

```python

'''7.绘制成绩雷达图'''
import numpy as np
import matplotlib.pyplot as plt
 
courses = ['C++', 'Python', 'Java', 'C', 'C#', 'Go', 'Matlab']
scores = [82,100,90,78,40,66,88]
 
datalength = len(scores)
angles = np.linspace(0, 2*np.pi, datalength, endpoint=False)    # 均分极坐标
 
scores.append(scores[0])    # 在末尾添加第一个值，保证曲线闭合
angles = np.append(angles, angles[0])
 
plt.polar(angles, scores, 'rv-', lw=2)
plt.thetagrids(angles*180/np.pi, courses, fontproperties='simhei')
plt.fill(angles, scores, facecolor='r', alpha=0.4)
```



![img](https://s2.loli.net/2021/12/09/y7MjEdcovuHWJNC.png)



- 绘制多个雷达图图案

```python
import matplotlib.pyplot as plt
import numpy as np

"""
绘制多个点，并且第一个点与最后一个点相同，使其成为闭合图案
"""

thete = np.array([0.35, 0.45, 0.64, 1, 1.3])
theta = np.array([0.25, 0.75, 1, 1.5, 0.25])
r = [20, 60, 40, 80, 20]
s = [10, 35, 25, 45, 16]
# 闭合图案背景样色为橙色
plt.polar(theta * np.pi, r, "o-", lw=2)
# 设置填充样色，并且透明度为0.75
plt.fill(theta * np.pi, r, "orange", alpha=0.75)
# 闭合图案背景样色为红色
plt.polar(thete * np.pi, s, "r-", lw=2)
plt.fill(thete * np.pi, s, "r", alpha=0.65)
plt.ylim(0, 100)
# 实现网格线
plt.grid(True)
plt.show()

```



![image-20211209220606746](https://s2.loli.net/2021/12/09/RQTE89zZlFcVpPG.png)



### 词语图：wordcold

#### Wordcloud各参数含义

```python
font_path : string  #字体路径，需要展现什么字体就把该字体路径+后缀名写上，如：font_path = '黑体.ttf'

width : int (default=400) #输出的画布宽度，默认为400像素

height : int (default=200) #输出的画布高度，默认为200像素

prefer_horizontal : float (default=0.90) #词语水平方向排版出现的频率，默认 0.9 （所以词语垂直方向排版出现频率为 0.1 ）

mask : nd-array or None (default=None) #如果参数为空，则使用二维遮罩绘制词云。如果 mask 非空，设置的宽高值将被忽略，遮罩形状被 mask 取代。除全白（#FFFFFF）的部分将不会绘制，其余部分会用于绘制词云。如：bg_pic = imread('读取一张图片.png')，背景图片的画布一定要设置为白色（#FFFFFF），然后显示的形状为不是白色的其他颜色。可以用ps工具将自己要显示的形状复制到一个纯白色的画布上再保存，就ok了。

scale : float (default=1) #按照比例进行放大画布，如设置为1.5，则长和宽都是原来画布的1.5倍

min_font_size : int (default=4) #显示的最小的字体大小

font_step : int (default=1) #字体步长，如果步长大于1，会加快运算但是可能导致结果出现较大的误差

max_words : number (default=200) #要显示的词的最大个数

stopwords : set of strings or None #设置需要屏蔽的词，如果为空，则使用内置的STOPWORDS

background_color : color value (default=”black”) #背景颜色，如background_color='white',背景颜色为白色

max_font_size : int or None (default=None) #显示的最大的字体大小

mode : string (default=”RGB”) #当参数为“RGBA”并且background_color不为空时，背景为透明

relative_scaling : float (default=.5) #词频和字体大小的关联性

color_func : callable, default=None #生成新颜色的函数，如果为空，则使用 self.color_func

regexp : string or None (optional) #使用正则表达式分隔输入的文本

collocations : bool, default=True #是否包括两个词的搭配

colormap : string or matplotlib colormap, default=”viridis” #给每个单词随机分配颜色，若指定color_func，则忽略该方法random_state : int or None  #为每个单词返回一个PIL颜色

fit_words(frequencies)  # 根据词频生成词云
generate(text)  # 根据文本生成词云
generate_from_frequencies(frequencies[, ...])   # 根据词频生成词云
generate_from_text(text)    # 根据文本生成词云
process_text(text)  # 将长文本分词并去除屏蔽词（此处指英语，中文分词还是需要自己用别的库先行实现，使用上面的 fit_words(frequencies) ）
recolor([random_state, color_func, colormap])   # 对现有输出重新着色。重新上色会比重新生成整个词云快很多
to_array()  # 转化为 numpy array
to_file(filename)   # 输出到文件
```



````python
from PIL import Image
from wordcloud import WordCloud, STOPWORDS
from matplotlib import pyplot as plt
import numpy as np
import jieba



fig, ax = plt.subplots()
with open(r'语文.txt', encoding='utf-8') as f:
    text = f.read()
t = " ".join(jieba.lcut(text, cut_all=False, HMM=False))
print(t)
shape = np.array(Image.open(r'cat.jpg'))
mycloudword = WordCloud(font_path=r'C:\Windows\Fonts\simsun.ttc',
                        width=800,
                        height=600,
                        mask=shape,
                        background_color='white',
                        min_font_size=10,
                        max_font_size=30,
                        max_words=200,
                        random_state=50).generate(t)

ax.imshow(mycloudword)
ax.axis("off")
plt.show()

mycloudword.to_file(r"语文.png")

````



#### 去除无用词汇

```python
from wordcloud import WordCloud
import jieba
from matplotlib import pyplot as plt
from collections import Counter

if __name__ == '__main__':
    with open("评论.txt", "r", encoding='utf-8') as fp:
        data = fp.read()
    # 进行分词
    data = jieba.lcut(data, cut_all=False)
    # 统计评论词汇出现的次数
    data2 = Counter(data).most_common(1000)
    print(data2)
    # 统计不行出现的次数
    data_txt = "".join(data).count("不行")
    print(data_txt)
    data = " ".join(data)
    # 去掉无用词汇
    txt = open("无用词汇.txt", encoding="utf-8").read()
    # generate -> 生成
    # 生成词云图
    con = WordCloud(
        font_path="C:\Windows\Fonts\simfang.ttf",
        width=800,
        height=600,
        background_color="white",
        stopwords=set(txt),
    ).generate(data)
    plt.imshow(con)
    plt.axis('off')
    plt.show()

```



#### 统计词云词汇出现的次数：

```python
from wordcloud import WordCloud
import jieba
from matplotlib import pyplot as plt
from collections import Counter

if __name__ == '__main__':
    with open("评论.txt", "r", encoding='utf-8') as fp:
        data = fp.read()
    # 进行分词
    data = jieba.lcut(data, cut_all=False)
    # 统计评论词汇出现的次数
    data2 = Counter(data).most_common(1000)
    print(data2)
    # data_txt = "".join(data).count("不行")
    # print(data_txt)
    data = " ".join(data)
    # 去掉无用词汇
    txt = open("无用词汇.txt", encoding="utf-8").read()
    # generate -> 生成
    # 生成词云图
    con = WordCloud(
        font_path="C:\Windows\Fonts\simfang.ttf",
        width=800,
        height=600,
        background_color="white",
        stopwords=txt,
    ).generate(data)
    plt.imshow(con)
    plt.axis('off')
    plt.show()
```

## 2. numpy

### 什么是numpy

一个Python中做科学计算的基础库，重在数值计算也是大部分Python科学计算库的基础库，多用于在大型、多维数组上执行数组运算

### 安装

使用`pip install numpy` 即可安装numpy 

### Ndarray 对象

NumPy 最重要的一个特点是其 N 维数组对象 ndarray，它是一系列同类型数据的集合，以 0 下标为开始进行集合中元素的索引。

ndarray 对象是用于存放同类型元素的多维数组。

ndarray 中的每个元素在内存中都有相同存储大小的区域。

ndarray 内部由以下内容组成：

- 一个指向数据（内存或内存映射文件中的一块数据）的指针。
- 数据类型或 dtype，描述在数组中的固定大小值的格子。
- 一个表示数组形状（shape）的元组，表示各维度大小的元组。
- 一个跨度元组（stride），其中的整数指的是为了前进到当前维度下一个元素需要"跨过"的字节数。

ndarray 的内部结构:

![img](https://i.loli.net/2021/11/10/S8juod7qARFUp4K.png)

跨度可以是负数，这样会使数组在内存中后向移动，切片中 **obj[::-1]** 或 **obj[:,::-1]** 就是如此。

创建一个 ndarray 只需调用 NumPy 的 array 函数即可：

```python
numpy.array(object, dtype = None, copy = True, order = None, subok = False, ndmin = 0)
```



**参数说明：**

| 名称   | 描述                                                      |
| ------ | --------------------------------------------------------- |
| object | 数组或嵌套的数列                                          |
| dtype  | 数组元素的数据类型，可选                                  |
| copy   | 对象是否需要复制，可选                                    |
| order  | 创建数组的样式，C为行方向，F为列方向，A为任意方向（默认） |
| subok  | 默认返回一个与基类类型一致的数组                          |
| ndmin  | 指定生成数组的最小维度                                    |



实例:

```python
import numpy as np 
a = np.array([1,2,3])  
print (a)
# [1, 2, 3]
```



```python
# 多于一个维度  
import numpy as np 
a = np.array([[1,  2],  [3,  4]])  
print (a)
"""
	[[1, 2]
	[3, 4]]
"""
```



```python
# 最小维度  
import numpy as np 
a = np.array([1, 2, 3, 4, 5], ndmin =  2)  
print (a)
# [[1 2 3 4 5]]
```



```python
# dtype 参数  
import numpy as np 
a = np.array([1,  2,  3], dtype = complex)  
print (a)
# [1.+0.j 2.+0.j 3.+0.j]
```



## 3. pandas



### 3.1 Series

Pandas Series 类似表格中的一个列（column），类似于一维数组，可以保存任何数据类型。

Series 由索引（index）和列组成，函数如下：

```python
pandas.Series(data, index, dtype, name, copy)
```



参数说明：

- data: 一组数据(ndarray类型)
- index： 数据索引标签，如果不指定，默认从0开始
- dtype： 数据类型，默认会自己判断
- name：设置名称
- copy： 拷贝数据， 默认为False



创建一个简单的实例：

```python
import pandas as pd
a = [1, 2, 3]
data = pd.Series(a)
print(data)

"""
索引 	     数据	
 0    		1
 1    		2
 2   		3
dtype: int64 # 数据类型
"""
```



从上可知，如果没有指定索引，索引值就从 0 开始，我们可以根据索引值读取数据



也可以通过下标的方式取值

```python
import pandas as pd

a = [1, 2, 3]
myvar = pd.Series(a)
print(myvar[1])

# 2
```



我们可以设置索引值

```python
import pandas as pd

a = ["Google", "Runoob", "Wiki"]
myvar = pd.Series(a, index = ["x", "y", "z"])
print(myvar)

"""
结果
    x Google
    y Runoob
    z Wiki
    dtype: object
"""
```



也可以通过索引取值

```python
import pandas as pd

a = ["Google", "Runoob", "Wiki"]
myvar = pd.Series(a, index = ["x", "y", "z"])
print(myvar["y"])

# Runoob
```



我们也可以使用 key/value 对象，类似字典来创建 Series：

```python
import pandas as pd

sites = {1: "Google", 2: "Runoob", 3: "Wiki"}
myvar = pd.Series(sites)
print(myvar)

"""
 1 		Google
 2		Runoob
 3		Wiki
 dtype: object
"""
```



从上可知，字典的key变成了索引值

如果我们只需要字典中的一部分数据，只需要指定需要数据的索引即可，如下实例

```python
import pandas as pd

sites = {1: "Google", 2: "Runoob", 3: "Wiki"}
myvar = pd.Series(sites, index = [1, 2])
print(myvar)

"""
1	Google
2	Runoob
dtype: object
"""
```



设置 Series 名称参数

```python
import pandas as pd

sites = {1: "Google", 2: "Runoob", 3: "Wiki"}
myvar = pd.Series(sites, index = [1, 2], name="RUNOOB-Series-TEST" )
print(myvar)

"""
1	Google
2	Runoob
Name: RUNOOB-Series-TEST, dtype: object
"""
```



### 3.2 读取外部数据

我们在进行解析时，数据是存在放文件中的，一般存放在csv文件和数据库中，这时我们就要读取数据来进行分析。

读取csv文件中的数据

```python
import pandas as pd
data = pandas.read_csv('dogNames2.csv')
print(data)
# read_csv默认打印前5条和后5条数据，如果想要展示所有数据则需要加上to_string() -> data.to_string()
"""
     Row_Labels  Count_AnimalName
0         RENNY                 1
1        DEEDEE                 2
2     GLADIATOR                 1
3        NESTLE                 1
4          NYKE                 1
...         ...               ...
4159    ALEXXEE                 1
4160  HOLLYWOOD                 1
4161      JANGO                 2
4162  SUSHI MAE                 1
4163      GHOST                 3

[4164 rows x 2 columns]

Process finished with exit code 0

"""
```



读取数据库操作

读取数据库可以使用MySQLdb或者pymysql连接数据库读取

pymysql

```python
import pandas as pd
import pymysql

my_sql = pymysql.connect(host='localhost', user='root', password='123456', database='blog')
df1 = pd.read_sql("select * from t_link", con=my_sql)
print(df)

```



```python
import pandas as pd
import pymysql

my_sql = MySQLdb.connect(host='localhost', user='root', password='123456', database='blog')
df1 = pd.read_sql("select * from t_link", con=my_sql)
print(df)
```



### 3.3 DataFrame

DataFrame 是一个表格型的数据结构，它含有一组有序的列，每列可以是不同的值类型（数值、字符串、布尔型值）。DataFrame 既有行索引也有列索引，它可以被看做由 Series 组成的字典（共同用一个索引）

DataFrame 构造方法如下：

```python
pandas.DataFrame( data, index, columns, dtype, copy)
```



参数说明：

- data: 一组数据(ndarray, series, map, list,dict等类型)
- index：索引值，或者可以称为行标签
- column：列标签，默认为RangeIndex (0, 1, 2, …, n)
- dtype：数据类型
- copy： 拷贝数据，默认为Flase

Pandas DataFrame 是一个二维的数组结构，类似二维数组

```python
import pandas as pd

data = [['Google',10],['Runoob',12],['Wiki',13]]

df = pd.DataFrame(data,columns=['Site','Age'],dtype=float)

print(df)

"""
结果
	Site	Age
0	Google	10.0
1	Runoob	12.0
2	Wiki	13.0
"""
```



以下实例使用 ndarrays 创建，ndarray 的长度必须相同， 如果传递了 index，则索引的长度应等于数组的长度。如果没有传递索引，则默认情况下，索引将是range(n)，其中n是数组长度。



```python
import pandas as pd

data = {'Site':['Google', 'Runoob', 'Wiki'], 'Age':[10, 12, 13]}

df = pd.DataFrame(data)

print (df)

"""
	Site	Age
0	Google	10.0
1	Runoob	12.0
2	Wiki	13.0
"""
```



从以上输出结果可以知道，DataFrame数据类型一个表格，包含rows（行）和 columns（列）：

![img](https://i.loli.net/2021/11/22/cuZYDptBFl5QS6J.png)



还可以使用字典（key/value)， 其中字典的key为列名。

```python
import pandas as pd

data = [{'a': 1, 'b': 2},{'a': 5, 'b': 10, 'c': 20}]

df = pd.DataFrame(data)

print (df)

"""
   a   b     c
0  1   2   NaN
1  5  10  20.0
"""
```



没有对应的部分数据为 **NaN**。



Pandas 可以使用 **loc** 属性返回指定行的数据，如果没有设置索引，第一行索引为 **0**，第二行索引为 **1**，以此类推：



```python
import pandas as pd

data = {
  "calories": [420, 380, 390],
  "duration": [50, 40, 45]
}

# 数据载入到 DataFrame 对象
df = pd.DataFrame(data)

# 返回第一行
print(df.loc[0])
# 返回第二行
print(df.loc[1])

"""
calories    420
duration     50
Name: 0, dtype: int64
calories    380
duration     40
Name: 1, dtype: int64
"""
```



**注意：**返回结果其实就是一个 Pandas Series 数据。

也可以返回多行数据，使用 **[[ ... ]]** 格式，**...** 为各行的索引，以逗号隔开：



```python
import pandas as pd

data = {
  "calories": [420, 380, 390],
  "duration": [50, 40, 45]
}

# 数据载入到 DataFrame 对象
df = pd.DataFrame(data)

# 返回第一行和第二行
print(df.loc[[0, 1]])
```



输出结果为：

```python
   calories  duration
0       420        50
1       380        40
```



**注意：**返回结果其实就是一个 Pandas DataFrame 数据。

我们可以指定索引值，如下实例：

```python
import pandas as pd

data = {
  "calories": [420, 380, 390],
  "duration": [50, 40, 45]
}

df = pd.DataFrame(data, index = ["day1", "day2", "day3"])

print(df)
```



输出结果为：

```python
      calories  duration
day1       420        50
day2       380        40
day3       390        45
```



Pandas 可以使用 **loc** 属性返回指定索引对应到某一行：

```python
import pandas as pd

data = {
  "calories": [420, 380, 390],
  "duration": [50, 40, 45]
}

df = pd.DataFrame(data, index = ["day1", "day2", "day3"])

# 指定索引
print(df.loc["day2"])
```



输出结果为：

```python
calories    380
duration     40
Name: day2, dtype: int64
```





### 3.4 数据清晰

数据清洗是对一些没有用的数据进行处理的过程。

很多数据集存在数据缺失、数据格式错误、错误数据或重复数据的情况，如果要对使数据分析更加准确，就需要对这些没有用的数据进行处理。



#### 3.4.1 清洗空值

如果我们要删除包含空字段的行，可以使用dropna（）方法，语法格式如下：

````python
DataFrame.dropna(axis=0, how='any', thresh=None, subset=None, inplace=False)
````



参数说明：

- axis: 默认为0，表示逢空值剔除整行，如果设置参数axis=1表示逢空值去掉整列
- how：默认为`any`如果一行（或一列）里任何一个数据有出现Na就去掉整行，如果设置how='all'一行（或列）都是Na才去掉这整行
- thresh: 设置需要多少非空值的数据才可以保留下来
- subset：如果想要检查的列。如果是多个列，可以使用列名的list作为参数。
- inplace：如果设置True，将计算得到的值直接覆盖之前的值并返回None，修改的是源数据



我们可以通过`isnull()`判断各个单元是否为空

```python
import pandas as pd

df = pd.read_csv('property-data.csv')

print (df['NUM_BEDROOMS'])
print (df['NUM_BEDROOMS'].isnull())
```



以上实例输出结果如下：![img](https://i.loli.net/2021/11/22/7UNGEFjsHVZO98Y.jpg)

以上例子中我们看到 Pandas 把 n/a 和 NA 当作空数据，na 不是空数据，不符合我们要求，我们可以指定空数据类型：

```python
import pandas as pd

missing_values = ["n/a", "na", "--"]
df = pd.read_csv('property-data.csv', na_values = missing_values)

print (df['NUM_BEDROOMS'])
print (df['NUM_BEDROOMS'].isnull())
```



以上实例输出结果如下：![img](https://i.loli.net/2021/11/22/IVi5sv2zgODKAFY.jpg)



#### 3.4.2 删除空数据

接下来的实例演示了删除包含空数据的行。

```python
import pandas as pd

df = pd.read_csv('property-data.csv')

new_df = df.dropna()

print(new_df.to_string())
```



以上实例输出结果如下：![img](https://i.loli.net/2021/11/22/X19SHv4hjictWfg.jpg)

**注意：**默认情况下，dropna() 方法返回一个新的 DataFrame，不会修改源数据。

如果你要修改源数据 DataFrame, 可以使用 **inplace = True** 参数:

```python
import pandas as pd

df = pd.read_csv('property-data.csv')

df.dropna(inplace = True)

print(df.to_string())
```



以上实例输出结果如下：![img](https://i.loli.net/2021/11/22/X19SHv4hjictWfg.jpg)

我们也可以移除指定列有空值的行：

```python

import pandas as pd

df = pd.read_csv('property-data.csv')
# 移除 ST_NUM 列中字段值为空的行：
df.dropna(subset=['ST_NUM'], inplace = True)

print(df.to_string())
```



以上实例输出结果如下：

![img](https://i.loli.net/2021/11/22/cKnITBqhM4kQ5Ze.jpg)



#### 3.4.3 Fillna替换空字段

我们也可以 **fillna()** 方法来替换一些空字段：

```python
import pandas as pd

df = pd.read_csv('property-data.csv')
# 使用 12345 替换空字段：
df.fillna(12345, inplace = True)

print(df.to_string())
```





![img](https://i.loli.net/2021/11/22/Gp3Z7K8t1a5id2g.jpg)



我们也可以指定某一个列来替换数据：

```python
import pandas as pd

df = pd.read_csv('property-data.csv')
# 使用 12345 替换 PID 为空数据：
df['PID'].fillna(12345, inplace = True)

print(df.to_string())
```



以上实例输出结果如下：

![img](https://i.loli.net/2021/11/22/iNVnd3clPKUhJuk.jpg)







#### 3.4.4 **mean()**、**median()** 和 **mode()**

替换空单元格的常用方法是计算列的均值、中位数值或众数。

Pandas使用 **mean()**、**median()** 和 **mode()** 方法计算列的均值（所有值加起来的平均值）、中位数值（排序后排在中间的数）和众数（出现频率最高的数）。

```python
import pandas as pd

df = pd.read_csv('property-data.csv')
# 使用 mean() 方法计算列的均值并替换空单元格：
x = df["ST_NUM"].mean()

df["ST_NUM"].fillna(x, inplace = True)

print(df.to_string())
```



以上实例输出结果如下，红框为计算的均值替换来空单元格：![img](https://i.loli.net/2021/11/22/8obYFHunwU2cOXd.jpg)



```python
import pandas as pd

df = pd.read_csv('property-data.csv')
# 使用 median() 方法计算列的中位数并替换空单元格：
x = df["ST_NUM"].median()

df["ST_NUM"].fillna(x, inplace = True)

print(df.to_string())
```



以上实例输出结果如下，红框为计算的中位数替换来空单元格：![img](https://i.loli.net/2021/11/22/N3eKbusiOpRIZ9l.jpg)



```python
import pandas as pd

df = pd.read_csv('property-data.csv')

# 使用 mode() 方法计算列的众数并替换空单元格：
x = df["ST_NUM"].mode()

df["ST_NUM"].fillna(x, inplace = True)

print(df.to_string())
```



以上实例输出结果如下，红框为计算的众数替换来空单元格：![img](https://i.loli.net/2021/11/22/HBEIsvJmLKURZh2.jpg)







#### 3.4.5 清洗格式错误数据

数据格式错误的单元格会使数据分析变得困难，甚至不可能。

我们可以通过包含空单元格的行，或者将列中的所有单元格转换为相同格式的数据。

以下实例会格式化日期：

```python
import pandas as pd

# 第三个日期格式错误
data = {
  "Date": ['2020/12/01', '2020/12/02' , '20201226'],
  "duration": [50, 40, 45]
}

df = pd.DataFrame(data, index = ["day1", "day2", "day3"])

df['Date'] = pd.to_datetime(df['Date'])

print(df.to_string())
```



以上实例输出结果如下：

```python
           Date  duration
day1 2020-12-01        50
day2 2020-12-02        40
day3 2020-12-26        45
```



#### 3.4.6 清洗错误数据

数据错误也是很常见的情况，我们可以对错误的数据进行替换或移除。

以下实例会替换错误年龄的数据：

```python
import pandas as pd

person = {
  "name": ['Google', 'Runoob' , 'Taobao'],
  "age": [50, 40, 12345]    # 12345 年龄数据是错误的
}

df = pd.DataFrame(person)

df.loc[2, 'age'] = 30 # 修改数据

print(df.to_string())
```



结果：

```python
     name  age
0  Google   50
1  Runoob   40
2  Taobao   30
```



也可以设置条件语句：

```python
import pandas as pd

person = {
  "name": ['Google', 'Runoob' , 'Taobao'],
  "age": [50, 200, 12345]    
}

df = pd.DataFrame(person)

# 将 age 大于 120 的设置为 120:
for x in df.index:
  if df.loc[x, "age"] > 120:
    df.loc[x, "age"] = 120

print(df.to_string())
```



结果：

```python
     name  age
0  Google   50
1  Runoob  120
2  Taobao  120
```



也可以将错误数据的行删除：

```python
import pandas as pd

person = {
  "name": ['Google', 'Runoob' , 'Taobao'],
  "age": [50, 40, 12345]    # 12345 年龄数据是错误的
}

df = pd.DataFrame(person)

for x in df.index:
  # 将 age 大于 120 的删除:
  if df.loc[x, "age"] > 120:
    df.drop(x, inplace = True)

print(df.to_string())
```



结果：

```python
     name  age
0  Google   50
1  Runoob   40
```



#### 3.4.7 清洗重复数据

果我们要清洗重复数据，可以使用 `duplicated() `和 `drop_duplicates() `方法。

如果对应的数据是重复的，`duplicated() `会返回 True，否则返回 False。

```python
import pandas as pd

person = {
  "name": ['Google', 'Runoob', 'Runoob', 'Taobao'],
  "age": [50, 40, 40, 23]  
}
df = pd.DataFrame(person)

print(df.duplicated())
```



结果：

```python
0    False
1    False
2     True
3    False
dtype: bool
```



删除重复数据，可以直接使用**drop_duplicates()** 方法。

```python
import pandas as pd

persons = {
  "name": ['Google', 'Runoob', 'Runoob', 'Taobao'],
  "age": [50, 40, 40, 23]  
}

df = pd.DataFrame(persons)

df.drop_duplicates(inplace = True)
print(df)
```



```python
     name  age
0  Google   50
1  Runoob   40
3  Taobao   23
```





#### 3.4.8 查看数据前五行数据或后五行数据

```python
df.head() | df,tail()
```



3.4.9 获取到唯一的数据

```python
df['Director'].unique()
```



#### 处理为0的数据：

当然并不是每次为0的都需要处理，计算平均值等情况，nan是不参与计算的，但是0会

```python
t[0==0]:np.nan
```





## 4. pyecharts

安装pyecharts

```python
pip(3) install pyecharts
```



### 快速上手

>首先开始来绘制你的第一个图表

````python
from pyecharts.charts import Bar

bar = Bar()
bar.add_xaxis(["衬衫", "羊毛衫", "雪纺衫", "裤子", "高跟鞋", "袜子"])
bar.add_yaxis("商家A", [5, 20, 36, 10, 75, 90])
# render 会生成本地 HTML 文件，默认会在当前目录生成 render.html 文件
# 也可以传入路径参数，如 bar.render("mycharts.html")
bar.render()
````

![img](https://i.loli.net/2021/11/23/ZBLvCwIon19rzbT.png)





>pyecharts 所有方法均支持链式调用。

````python
from pyecharts.charts import Bar

bar = (
    Bar()
    .add_xaxis(["衬衫", "羊毛衫", "雪纺衫", "裤子", "高跟鞋", "袜子"])
    .add_yaxis("商家A", [5, 20, 36, 10, 75, 90])
)
bar.render()
````



>使用 options 配置项，在 pyecharts 中，一切皆 Options。

````python
from pyecharts.charts import Bar
from pyecharts import options as opts

# V1 版本开始支持链式调用
# 你所看到的格式其实是 `black` 格式化以后的效果
# 可以执行 `pip install black` 下载使用
bar = (
    Bar()
    .add_xaxis(["衬衫", "羊毛衫", "雪纺衫", "裤子", "高跟鞋", "袜子"])
    .add_yaxis("商家A", [5, 20, 36, 10, 75, 90])
    .set_global_opts(title_opts=opts.TitleOpts(title="主标题", subtitle="副标题"))
    # 或者直接使用字典参数
    # .set_global_opts(title_opts={"text": "主标题", "subtext": "副标题"})
)
bar.render()

# 不习惯链式调用的开发者依旧可以单独调用方法
bar = Bar()
bar.add_xaxis(["衬衫", "羊毛衫", "雪纺衫", "裤子", "高跟鞋", "袜子"])
bar.add_yaxis("商家A", [5, 20, 36, 10, 75, 90])
bar.set_global_opts(title_opts=opts.TitleOpts(title="主标题", subtitle="副标题"))
bar.render()
````



![img](https://i.loli.net/2021/11/23/QefynkmjUaKYpXq.png)

### 全局配置项

![img](https://i.loli.net/2021/11/23/5bn4FKlPtLHWgB8.png)

全局配置项可通过 `set_global_opts` 方法设置

#### InitOpts：初始化配置

```python
class InitOpts(
    # 图表画布宽度，css 长度单位。
    width: str = "900px",

    # 图表画布高度，css 长度单位。
    height: str = "500px",

    # 图表 ID，图表唯一标识，用于在多图表时区分。
    chart_id: Optional[str] = None,

    # 渲染风格，可选 "canvas", "svg"
    # # 参考 `全局变量` 章节
    renderer: str = RenderType.CANVAS,

    # 网页标题
    page_title: str = "Awesome-pyecharts",

    # 图表主题
    theme: str = "white",

    # 图表背景颜色
    bg_color: Optional[str] = None,

    # 远程 js host，如不设置默认为 https://assets.pyecharts.org/assets/"
    # 参考 `全局变量` 章节
    js_host: str = "",

    # 画图动画初始化配置，参考 `global_options.AnimationOpts`
    animation_opts: Union[AnimationOpts, dict] = AnimationOpts(),
)
```



```python
from pyecharts.charts import Bar
from pyecharts import options as opts
from pyecharts.globals import ThemeType

bar = (
    Bar(
        # 配置初始化
        init_opts=opts.InitOpts(
            # 给图表画布设置宽度
            width="1000px",
            # 给图表画布设置高度
            height="800px",
            # 设置网页标题
            page_title="叶枫",
            # 图表主题
            theme=ThemeType.LIGHT,
            # 图表背景颜色
            bg_color="pink"
        )
    )
    .add_xaxis(["衬衫", "羊毛衫", "雪纺衫", "裤子", "高跟鞋", "袜子", "爱心", "德玛", "赵信", "皇子", "加里奥"])
    .add_yaxis("A", [5, 10, 20, 13, 8, 9, 10, 12, 20, 16, 12])
    .add_yaxis("D", [5, 3, 10, 13, 8, 9, 10, 11, 12, 15, 17])
    .set_global_opts()
)
bar.render()

```



![image-20211124100522353](https://i.loli.net/2021/11/24/oyCbNWYmDXHwFvT.png)

#### TitleOpts: 标题配置项

```python
class TitleOpts(
    # 主标题文本，支持使用 \n 换行。
    title: Optional[str] = None,

    # 主标题跳转 URL 链接
    title_link: Optional[str] = None,

    # 主标题跳转链接方式
    # 默认值是: blank
    # 可选参数: 'self', 'blank'
    # 'self' 当前窗口打开; 'blank' 新窗口打开
    title_target: Optional[str] = None,

    # 副标题文本，支持使用 \n 换行。
    subtitle: Optional[str] = None,

    # 副标题跳转 URL 链接
    subtitle_link: Optional[str] = None,

    # 副标题跳转链接方式
    # 默认值是: blank
    # 可选参数: 'self', 'blank'
    # 'self' 当前窗口打开; 'blank' 新窗口打开
    subtitle_target: Optional[str] = None,

    # title 组件离容器左侧的距离。
    # left 的值可以是像 20 这样的具体像素值，可以是像 '20%' 这样相对于容器高宽的百分比，
    # 也可以是 'left', 'center', 'right'。
    # 如果 left 的值为'left', 'center', 'right'，组件会根据相应的位置自动对齐。
    pos_left: Optional[str] = None,

    # title 组件离容器右侧的距离。
    # right 的值可以是像 20 这样的具体像素值，可以是像 '20%' 这样相对于容器高宽的百分比。
    pos_right: Optional[str] = None,

    # title 组件离容器上侧的距离。
    # top 的值可以是像 20 这样的具体像素值，可以是像 '20%' 这样相对于容器高宽的百分比，
    # 也可以是 'top', 'middle', 'bottom'。
    # 如果 top 的值为'top', 'middle', 'bottom'，组件会根据相应的位置自动对齐。
    pos_top: Optional[str] = None,

    # title 组件离容器下侧的距离。
    # bottom 的值可以是像 20 这样的具体像素值，可以是像 '20%' 这样相对于容器高宽的百分比。
    pos_bottom: Optional[str] = None,

    # 标题内边距，单位px，默认各方向内边距为5，接受数组分别设定上右下左边距。
    # // 设置内边距为 5
    # padding: 5
    # // 设置上下的内边距为 5，左右的内边距为 10
    # padding: [5, 10]
    # // 分别设置四个方向的内边距
    # padding: [
    #     5,  // 上
    #     10, // 右
    #     5,  // 下
    #     10, // 左
    # ]
    padding: Union[Sequence, Numeric] = 5,

    # 主副标题之间的间距。
    item_gap: Numeric = 10,

    # 主标题字体样式配置项，参考 `series_options.TextStyleOpts`
    title_textstyle_opts: Union[TextStyleOpts, dict, None] = None,

    # 副标题字体样式配置项，参考 `series_options.TextStyleOpts`
    subtitle_textstyle_opts: Union[TextStyleOpts, dict, None] = None,
)
```



设置标题所有参数如上接下来我们测试如何设置主标题和副标题和标题链接

##### 主标题和副标题

```python
from pyecharts.charts import Bar
from pyecharts import options as opts

bar = (
    Bar()
    .add_xaxis(["衬衫", "羊毛衫", "雪纺衫", "裤子", "高跟鞋", "袜子"])
    .add_yaxis("A", [5, 10, 20, 13, 8, 9, 10])
    .add_yaxis("B", [5, 3, 10, 13, 8, 9, 10])
    .set_global_opts(
        title_opts=opts.TitleOpts(
            # 设置主标题
            title="阿里云销售量",
            # 设置主标题跳转链接，用户点击链接跳转到某个网页
            title_link="https://www.bilibili.com/",
            # 设置副标题
            subtitle="叶枫店铺",
        )
    )
)
bar.render()

```



![image-20211123162925562](https://i.loli.net/2021/11/23/3aDVeI5rg78BPNF.png)



我们点击阿里云销售量，则会跳转到哔哩哔哩网站

![image-20211123163025675](https://i.loli.net/2021/11/23/VlZ2MCo4UYDdKy5.png)

如果我们不想要点击之后用新窗口打开，只需要把 `title_target = 'self'` 即可

```python
from pyecharts.charts import Bar
from pyecharts import options as opts

bar = (
    Bar()
    .add_xaxis(["衬衫", "羊毛衫", "雪纺衫", "裤子", "高跟鞋", "袜子"])
    .add_yaxis("A", [5, 10, 20, 13, 8, 9, 10])
    .add_yaxis("B", [5, 3, 10, 13, 8, 9, 10])
    .set_global_opts(
        title_opts=opts.TitleOpts(
            # 设置主标题
            title="阿里云销售量",
            # 设置主标题跳转链接，用户点击链接跳转到某个网页
            title_link="https://www.bilibili.com/",
            title_target="self",
            # 设置副标题
            subtitle="叶枫店铺",
        )
    )
)
bar.render()
```



副标题也是可以设置跳转链接的，这里不在演示



##### 标题在图标位置

标题的位置可以设置在上下左右，其次上下位置起始位置在最左侧往上(下)移动，左右的起始位置在顶部，往左（右）方向移动

![QQ图片20211123170627](https://i.loli.net/2021/11/23/dD4ZwxbkQXh5Cv2.png)

```python
from pyecharts.charts import Bar
from pyecharts import options as opts

bar = (
    Bar()
    .add_xaxis(["衬衫", "羊毛衫", "雪纺衫", "裤子", "高跟鞋", "袜子"])
    .add_yaxis("A", [5, 10, 20, 13, 8, 9, 10])
    .add_yaxis("B", [5, 3, 10, 13, 8, 9, 10])
    .set_global_opts(
        title_opts=opts.TitleOpts(
            # 设置主标题
            title="阿里云销售量",
            # 设置主标题跳转链接，用户点击链接跳转到某个网页
            title_link="https://www.bilibili.com/",
            title_target="self",
            # 设置副标题
            subtitle="叶枫店铺",
            # 设置标题的位置
            # pos_right="left",
            # 可以是像 20 这样的具体像素值，可以是像 '20%' 这样相对于容器高宽的百分比。
            pos_right="30"
        )
    )
)
bar.render()
```



##### 标题内边距

标题内边距，单位px，默认各方向内边距为5，接受数组分别设定上右下左边距。

````python
from pyecharts.charts import Bar
from pyecharts import options as opts

bar = (
    Bar()
    .add_xaxis(["衬衫", "羊毛衫", "雪纺衫", "裤子", "高跟鞋", "袜子"])
    .add_yaxis("A", [5, 10, 20, 13, 8, 9, 10])
    .add_yaxis("B", [5, 3, 10, 13, 8, 9, 10])
    .set_global_opts(
        title_opts=opts.TitleOpts(
            # 设置主标题
            title="阿里云销售量",
            # 设置主标题跳转链接，用户点击链接跳转到某个网页
            title_link="https://www.bilibili.com/",
            title_target="self",
            # 设置副标题
            subtitle="叶枫店铺",
            # 设置内边距为 450
            padding=450
        )
    )
)
bar.render()

````

![1](https://i.loli.net/2021/11/23/drStoZaP4yQKu1B.png)

也可以使用list设置不同的内边距

```python
from pyecharts.charts import Bar
from pyecharts import options as opts

bar = (
    Bar()
    .add_xaxis(["衬衫", "羊毛衫", "雪纺衫", "裤子", "高跟鞋", "袜子"])
    .add_yaxis("A", [5, 10, 20, 13, 8, 9, 10])
    .add_yaxis("B", [5, 3, 10, 13, 8, 9, 10])
    .set_global_opts(
        title_opts=opts.TitleOpts(
            # 设置主标题
            title="阿里云销售量",
            # 设置主标题跳转链接，用户点击链接跳转到某个网页
            title_link="https://www.bilibili.com/",
            title_target="self",
            # 设置副标题
            subtitle="叶枫店铺",
            # 设置上边距为100px，右边为200，下边为300，左边为400
            padding=[
                100,
                200,
                300,
                400
            ]
        )
    )
)
bar.render()

```



![image-20211123172820055](https://i.loli.net/2021/11/23/qAPC9v8dSIYiMr3.png)

##### 主副标题之间的间距

我们不想主标题和副标题离得太近，也可以给主副标题之间的间距进行设置。

```python
from pyecharts.charts import Bar
from pyecharts import options as opts

bar = (
    Bar()
    .add_xaxis(["衬衫", "羊毛衫", "雪纺衫", "裤子", "高跟鞋", "袜子"])
    .add_yaxis("A", [5, 10, 20, 13, 8, 9, 10])
    .add_yaxis("B", [5, 3, 10, 13, 8, 9, 10])
    .set_global_opts(
        title_opts=opts.TitleOpts(
            # 设置主标题
            title="阿里云销售量",
            # 设置主标题跳转链接，用户点击链接跳转到某个网页
            title_link="https://www.bilibili.com/",
            title_target="self",
            # 设置副标题
            subtitle="叶枫店铺",
            # 设置主副标题之间的间距，单位为px
            item_gap=100,
        )
    )
)
bar.render()
```



![image-20211123173112900](https://i.loli.net/2021/11/23/gWs29e1O5N3bMJS.png)



#### LegendOpts：图例配置项

````python
class LegendOpts(
    # 图例的类型。可选值：
    # 'plain'：普通图例。缺省就是普通图例。
    # 'scroll'：可滚动翻页的图例。当图例数量较多时可以使用。
    type_: Optional[str] = None,

    # 图例选择的模式，控制是否可以通过点击图例改变系列的显示状态。默认开启图例选择，可以设成 false 关闭
    # 除此之外也可以设成 'single' 或者 'multiple' 使用单选或者多选模式。
    selected_mode: Union[str, bool, None] = None,

    # 是否显示图例组件
    is_show: bool = True,

    # 图例组件离容器左侧的距离。
    # left 的值可以是像 20 这样的具体像素值，可以是像 '20%' 这样相对于容器高宽的百分比，
    # 也可以是 'left', 'center', 'right'。
    # 如果 left 的值为'left', 'center', 'right'，组件会根据相应的位置自动对齐。
    pos_left: Union[str, Numeric, None] = None,

    # 图例组件离容器右侧的距离。
    # right 的值可以是像 20 这样的具体像素值，可以是像 '20%' 这样相对于容器高宽的百分比。
    pos_right: Union[str, Numeric, None] = None,

    # 图例组件离容器上侧的距离。
    # top 的值可以是像 20 这样的具体像素值，可以是像 '20%' 这样相对于容器高宽的百分比，
    # 也可以是 'top', 'middle', 'bottom'。
    # 如果 top 的值为'top', 'middle', 'bottom'，组件会根据相应的位置自动对齐。
    pos_top: Union[str, Numeric, None] = None,

    # 图例组件离容器下侧的距离。
    # bottom 的值可以是像 20 这样的具体像素值，可以是像 '20%' 这样相对于容器高宽的百分比。
    pos_bottom: Union[str, Numeric, None] = None,

    # 图例列表的布局朝向。可选：'horizontal', 'vertical'
    orient: Optional[str] = None,

    # 图例标记和文本的对齐。默认自动（auto）
    # 根据组件的位置和 orient 决定
    # 当组件的 left 值为 'right' 以及纵向布局（orient 为 'vertical'）的时候为右对齐，即为 'right'。
    # 可选参数: `auto`, `left`, `right`
    align: Optional[str] = None,

    # 图例内边距，单位px，默认各方向内边距为5
    padding: int = 5,

    # 图例每项之间的间隔。横向布局时为水平间隔，纵向布局时为纵向间隔。
    # 默认间隔为 10
    item_gap: int = 10,

    # 图例标记的图形宽度。默认宽度为 25
    item_width: int = 25,

    # 图例标记的图形高度。默认高度为 14
    item_height: int = 14,

    # 图例关闭时的颜色。默认是 #ccc
    inactive_color: Optional[str] = None,

    # 图例组件字体样式，参考 `series_options.TextStyleOpts`
    textstyle_opts: Union[TextStyleOpts, dict, None] = None,

    # 图例项的 icon。
    # ECharts 提供的标记类型包括 'circle', 'rect', 'roundRect', 'triangle', 'diamond', 'pin', 'arrow', 'none'
    # 可以通过 'image://url' 设置为图片，其中 URL 为图片的链接，或者 dataURI。
    # 可以通过 'path://' 将图标设置为任意的矢量路径。
    legend_icon: Optional[str] = None,
)
````



通过上述，假设我们想要图形只能展示一种数据，不要展示两种我们，则可以通过图例配置来进行设置

##### 单例模式

```python
from pyecharts.charts import Bar
from pyecharts import options as opts

bar = (
    Bar()
    .add_xaxis(["衬衫", "羊毛衫", "雪纺衫", "裤子", "高跟鞋", "袜子", "爱心", "德玛", "赵信", "皇子", "加里奥"])
    .add_yaxis("A", [5, 10, 20, 13, 8, 9, 10, 12, 20, 16, 12])
    .add_yaxis("H", [5, 10, 20, 13, 8, 9, 10, 12, 20, 16, 12])
    .add_yaxis("J", [5, 10, 20, 13, 8, 9, 10, 12, 20, 16, 12])
    .add_yaxis("K", [5, 10, 20, 13, 8, 9, 10, 12, 20, 16, 12])
    .add_yaxis("L", [5, 3, 10, 13, 8, 9, 10, 11, 12, 15, 17])
    .add_yaxis("C", [5, 3, 10, 13, 8, 9, 10, 11, 12, 15, 17])
    .add_yaxis("D", [5, 3, 10, 13, 8, 9, 10, 11, 12, 15, 17])
    .add_yaxis("E", [5, 3, 10, 13, 8, 9, 10, 11, 12, 15, 17])
    .add_yaxis("F", [5, 3, 10, 13, 8, 9, 10, 11, 12, 15, 17])
    .set_global_opts(
        legend_opts=opts.LegendOpts(
            # 设置成单例模式，数据只会展示一种
            selected_mode="single"
        )
    )
)
bar.render()
```



![image-20211123211136429](https://i.loli.net/2021/11/23/N34aYlgz52mbkOP.png)

将`selected_mode="single"`就可以实现该功能，文档上说可以直接赋值`false`，我试了一下发现没有用



##### 开关闭图例

```python
legend_opts=opts.LegendOpts(
     # 默认是True开启模式，设置成False则是关闭
               is_show: bool = False,
        )
```



##### 图例位置

```python
            # 设置图例的位置
            # pos_right="left",
            # 可以是像 20 这样的具体像素值，可以是像 '20%' 这样相对于容器高宽的百分比。
            pos_right="30"
```



##### 图例的布局朝向

布局朝向指的就是图例排序，我们不想图例从左到右，想要它从上到下进行排序

![img](https://i.loli.net/2021/11/23/RwSnJUFrtiH4yKI.png)

```python
from pyecharts.charts import Bar
from pyecharts import options as opts

bar = (
    Bar()
    .add_xaxis(["衬衫", "羊毛衫", "雪纺衫", "裤子", "高跟鞋", "袜子", "爱心", "德玛", "赵信", "皇子", "加里奥"])
    .add_yaxis("A", [5, 10, 20, 13, 8, 9, 10, 12, 20, 16, 12])
    .add_yaxis("D", [5, 3, 10, 13, 8, 9, 10, 11, 12, 15, 17])

    .set_global_opts(
        legend_opts=opts.LegendOpts(
            # 设置成单例模式，数据只会展示一种
            # selected_mode="single",
			# 图例则会从上到下排序，默认为horizontal：从左至右
            orient="vertical"
        )
    )
)
bar.render()
```

![image-20211123212637320](https://i.loli.net/2021/11/23/OYse8IwUkEniyVb.png)

##### 图例每项之间的间隔

图例横向布局时为水平间隔，纵向布局时为纵向间隔。默认间隔为 10。

```python
        legend_opts=opts.LegendOpts(
            # 默认间隔为 10
            item_gap= 10,
        )
```



##### 设置图例标记图形高度和宽度

```python
legend_opts=opts.LegendOpts(
     # 图例标记的图形宽度。默认宽度为 25
     item_width=25,
    # 图例标记的图形高度。默认高度为 14
    item_height=14,
)
```



##### 关闭图标颜色

```python
legend_opts=opts.LegendOpts(
    # 图例关闭时的颜色。默认是 #ccc
    inactive_color="#3333",
)

```





#### TooltipOpts:提示框配置项

##### 关闭提示项

设置成False之后鼠标移动到图标上不会在有提示

```python
        tooltip_opts=opts.TooltipOpts(
            # 默认是True
            is_show=False,
        )
```



##### 设置触发类型

'item': 数据项图形触发，主要在散点图，饼图等无类目轴的图表中使用

'axis': 坐标轴触发，主要在柱状图，折线图等会使用类目轴的图表中使用。

'none': 什么都不触发

```python
from pyecharts.charts import Bar
from pyecharts import options as opts

bar = (
    Bar()
    .add_xaxis(["衬衫", "羊毛衫", "雪纺衫", "裤子", "高跟鞋", "袜子", "爱心", "德玛", "赵信", "皇子", "加里奥"])
    .add_yaxis("A", [5, 10, 20, 13, 8, 9, 10, 12, 20, 16, 12])
    .add_yaxis("D", [5, 3, 10, 13, 8, 9, 10, 11, 12, 15, 17])

    .set_global_opts(
        tooltip_opts=opts.TooltipOpts(
            is_show=True,
            trigger="axis",
        )
    )
)
bar.render()
```



![img](https://i.loli.net/2021/11/23/6Yg7r8wLmviT4FK.png)



##### 提示框触发的条件

我也可以设置成用户点击图标之后，才弹出提示

```python
        tooltip_opts=opts.TooltipOpts(
            is_show=True,
            trigger="axis",
            # 默认为 "mousemove|click"
            trigger_on="click"
        )
```





##### 指示器类型

| 参数类型 | 功能                                                         |
| -------- | ------------------------------------------------------------ |
| line     | 直线指示器                                                   |
| shadow   | 阴影指示器                                                   |
| none     | 无指示器                                                     |
| cross    | 十字准星指示器。其实是种简写，表示启用两个正交的轴的 axisPointer。 |

什么是指示器？就是这条线

```python
from pyecharts.charts import Bar
from pyecharts import options as opts

bar = (
    Bar()
    .add_xaxis(["衬衫", "羊毛衫", "雪纺衫", "裤子", "高跟鞋", "袜子", "爱心", "德玛", "赵信", "皇子", "加里奥"])
    .add_yaxis("A", [5, 10, 20, 13, 8, 9, 10, 12, 20, 16, 12])
    .add_yaxis("D", [5, 3, 10, 13, 8, 9, 10, 11, 12, 15, 17])
    .set_global_opts(
        tooltip_opts=opts.TooltipOpts(
            is_show=True,
            trigger="axis",
            # 默认为line
            axis_pointer_type="line"
        )
    )
)
bar.render()
```



![img](https://i.loli.net/2021/11/23/6Yg7r8wLmviT4FK.png)

设置成shadow则是这张图片

![image-20211123215600284](https://i.loli.net/2021/11/23/ZFtyw8LmzJEb3pI.png)

设置成cross则是这样

![image-20211123215654858](https://i.loli.net/2021/11/23/CeQO2uyhZHRX56J.png)



#### DataZoomOpts: 区域缩放配置项

##### 显示或关闭区域缩放

```python
from pyecharts.charts import Bar
from pyecharts import options as opts

bar = (
    Bar()
    .add_xaxis(["衬衫", "羊毛衫", "雪纺衫", "裤子", "高跟鞋", "袜子", "爱心", "德玛", "赵信", "皇子", "加里奥"])
    .add_yaxis("A", [5, 10, 20, 13, 8, 9, 10, 12, 20, 16, 12])
    .add_yaxis("D", [5, 3, 10, 13, 8, 9, 10, 11, 12, 15, 17])
    .set_global_opts(
        tooltip_opts=opts.TooltipOpts(
            is_show=True,
            trigger="axis",
            axis_pointer_type="cross"
        ),
        datazoom_opts=opts.DataZoomOpts(
            # 默认为True，如果设置为 false，不会显示，但是数据过滤的功能还存在。
            is_show=True
        )
    )
)
bar.render()
```

![img](https://i.loli.net/2021/11/24/t4RKfWom7kM5Vny.png)



##### 滚动滑轮图表区域缩放

如果我们不想缩放滑轮显示在图标下面，我们想要把鼠标放在图表上滚动鼠标滑轮，图表进行缩放则需这样

```python
from pyecharts.charts import Bar
from pyecharts import options as opts

bar = (
    Bar()
    .add_xaxis(["衬衫", "羊毛衫", "雪纺衫", "裤子", "高跟鞋", "袜子", "爱心", "德玛", "赵信", "皇子", "加里奥"])
    .add_yaxis("A", [5, 10, 20, 13, 8, 9, 10, 12, 20, 16, 12])
    .add_yaxis("D", [5, 3, 10, 13, 8, 9, 10, 11, 12, 15, 17])
    .set_global_opts(
        tooltip_opts=opts.TooltipOpts(
            is_show=True,
            trigger="axis",
            axis_pointer_type="cross"
        ),
        datazoom_opts=opts.DataZoomOpts(
            is_show=True,
            # 鼠标滚动滑轮，图表进行缩放
            type_="inside"
        )
    )
)
bar.render()
```



##### 窗口范围百分比

起始比例为20%，结束比例为80%，如果设置了`range_start`那么`start_value`则无效

```python
datazoom_opts=opts.DataZoomOpts(
            is_show=True,
            # 鼠标滚动滑轮，图表进行缩放
    # 数据窗口范围的起始百分比。范围是：0 ~ 100。表示 0% ~ 100%。
            range_start=20,
    		range_end=80
        )
```





##### 设置垂直滚动

```python
from pyecharts.charts import Bar
from pyecharts import options as opts

bar = (
    Bar()
    .add_xaxis(["衬衫", "羊毛衫", "雪纺衫", "裤子", "高跟鞋", "袜子", "爱心", "德玛", "赵信", "皇子", "加里奥"])
    .add_yaxis("A", [5, 10, 20, 13, 8, 9, 10, 12, 20, 16, 12])
    .add_yaxis("D", [5, 3, 10, 13, 8, 9, 10, 11, 12, 15, 17])
    .set_global_opts(
        tooltip_opts=opts.TooltipOpts(
            is_show=True,
            trigger="axis",
            axis_pointer_type="cross"
        ),
        datazoom_opts=opts.DataZoomOpts(
            is_show=True,
            # 鼠标滚动滑轮，图表进行缩放
            # 滑块默认为水平，设置vertical则是垂直
            orient="vertical"
        )
    )
)
bar.render()
```



![image-20211124085648552](https://i.loli.net/2021/11/24/I3BeV18Z4NE7Asw.png)



#### VisualMapOpts：视觉映射配置项

##### 显示关闭视觉映射

```python
from pyecharts.charts import Bar
from pyecharts import options as opts

bar = (
    Bar()
    .add_xaxis(["衬衫", "羊毛衫", "雪纺衫", "裤子", "高跟鞋", "袜子", "爱心", "德玛", "赵信", "皇子", "加里奥"])
    .add_yaxis("A", [5, 10, 20, 13, 8, 9, 10, 12, 20, 16, 12])
    .add_yaxis("D", [5, 3, 10, 13, 8, 9, 10, 11, 12, 15, 17])
    .set_global_opts(
        visualmap_opts=opts.VisualMapOpts(
            is_show=True,
        )
    )
)
bar.render()

```

![image-20211124092159941](https://i.loli.net/2021/11/24/fk16zdUWgsVT3AS.png)

##### 更改映射过渡类型

```python
from pyecharts.charts import Bar
from pyecharts import options as opts

bar = (
    Bar()
    .add_xaxis(["衬衫", "羊毛衫", "雪纺衫", "裤子", "高跟鞋", "袜子", "爱心", "德玛", "赵信", "皇子", "加里奥"])
    .add_yaxis("A", [5, 10, 20, 13, 8, 9, 10, 12, 20, 16, 12])
    .add_yaxis("D", [5, 3, 10, 13, 8, 9, 10, 11, 12, 15, 17])
    .set_global_opts(
        visualmap_opts=opts.VisualMapOpts(
            type_="size",
        )
    )
)
bar.render()

```



![image-20211124092526151](https://i.loli.net/2021/11/24/DJH7sSmg5hGcFPE.png)



#####  指定映射最小值和最大值

```python
from pyecharts.charts import Bar
from pyecharts import options as opts

bar = (
    Bar()
    .add_xaxis(["衬衫", "羊毛衫", "雪纺衫", "裤子", "高跟鞋", "袜子", "爱心", "德玛", "赵信", "皇子", "加里奥"])
    .add_yaxis("A", [5, 10, 20, 13, 8, 9, 10, 12, 20, 16, 12])
    .add_yaxis("D", [5, 3, 10, 13, 8, 9, 10, 11, 12, 15, 17])
    .set_global_opts(
        visualmap_opts=opts.VisualMapOpts(
            # 设置最小值和最大值
            min_=10,
            max_=20
        )
    )
)
bar.render()
```



![img](https://i.loli.net/2021/11/24/bVKoek61EaxdAQl.png)

##### 给映射过滤设置文本

```python
from pyecharts.charts import Bar
from pyecharts import options as opts

bar = (
    Bar()
    .add_xaxis(["衬衫", "羊毛衫", "雪纺衫", "裤子", "高跟鞋", "袜子", "爱心", "德玛", "赵信", "皇子", "加里奥"])
    .add_yaxis("A", [5, 10, 20, 13, 8, 9, 10, 12, 20, 16, 12])
    .add_yaxis("D", [5, 3, 10, 13, 8, 9, 10, 11, 12, 15, 17])
    .set_global_opts(
        visualmap_opts=opts.VisualMapOpts(
            # 设置最小值和最大值
            min_=10,
            max_=20,
            # 两端的文本 参数类型可以是list|tuple
            range_text=["最大值", "最小值"]
        )
    )
)
bar.render()
```



![img](https://i.loli.net/2021/11/24/GtX51s3Iqakrepn.png)



##### 映射过滤设置颜色

````python
from pyecharts.charts import Bar
from pyecharts import options as opts

bar = (
    Bar()
    .add_xaxis(["衬衫", "羊毛衫", "雪纺衫", "裤子", "高跟鞋", "袜子", "爱心", "德玛", "赵信", "皇子", "加里奥"])
    .add_yaxis("A", [5, 10, 20, 13, 8, 9, 10, 12, 20, 16, 12])
    .add_yaxis("D", [5, 3, 10, 13, 8, 9, 10, 11, 12, 15, 17])
    .set_global_opts(
        visualmap_opts=opts.VisualMapOpts(
            # 设置最小值和最大值
            min_=10,
            max_=20,
            # 两端的文本 参数类型可以是list|tuple
            range_text=["最大值", "最小值"],
            # 自定义设置颜色
            range_color=["#0099CC", "#CCCCCC", "#FF6666"]
        )
    )
)
bar.render()
````



![image-20211124094237673](https://i.loli.net/2021/11/24/IfEgrSOkVT6ayL2.png)



##### 映射图标水平方向

```python
from pyecharts.charts import Bar
from pyecharts import options as opts

bar = (
    Bar()
    .add_xaxis(["衬衫", "羊毛衫", "雪纺衫", "裤子", "高跟鞋", "袜子", "爱心", "德玛", "赵信", "皇子", "加里奥"])
    .add_yaxis("A", [5, 10, 20, 13, 8, 9, 10, 12, 20, 16, 12])
    .add_yaxis("D", [5, 3, 10, 13, 8, 9, 10, 11, 12, 15, 17])
    .set_global_opts(
        visualmap_opts=opts.VisualMapOpts(
            # 设置最小值和最大值
            min_=10,
            max_=20,
            # 两端的文本 参数类型可以是list|tuple
            range_text=["最大值", "最小值"],
            # 自定义设置颜色
            range_color=["#0099CC", "#CCCCCC", "#FF6666"],
            range_size=[30, 20, 10],
            orient="horizontal"
        )
    )
)
bar.render()
```



#### AxiosOpts:坐标轴配置项

```python
class AxisOpts(
    # 坐标轴类型。可选：
    # 'value': 数值轴，适用于连续数据。
    # 'category': 类目轴，适用于离散的类目数据，为该类型时必须通过 data 设置类目数据。
    # 'time': 时间轴，适用于连续的时序数据，与数值轴相比时间轴带有时间的格式化，在刻度计算上也有所不同，
    # 例如会根据跨度的范围来决定使用月，星期，日还是小时范围的刻度。
    # 'log' 对数轴。适用于对数数据。
    type_: Optional[str] = None,

    # 坐标轴名称。
    name: Optional[str] = None,

    # 是否显示 x 轴。
    is_show: bool = True,

    # 只在数值轴中（type: 'value'）有效。
    # 是否是脱离 0 值比例。设置成 true 后坐标刻度不会强制包含零刻度。在双数值轴的散点图中比较有用。
    # 在设置 min 和 max 之后该配置项无效。
    is_scale: bool = False,

    # 是否反向坐标轴。
    is_inverse: bool = False,

    # 坐标轴名称显示位置。可选：
    # 'start', 'middle' 或者 'center','end'
    name_location: str = "end",

    # 坐标轴名称与轴线之间的距离。
    name_gap: Numeric = 15,

    # 坐标轴名字旋转，角度值。
    name_rotate: Optional[Numeric] = None,

    # 强制设置坐标轴分割间隔。
    # 因为 splitNumber 是预估的值，实际根据策略计算出来的刻度可能无法达到想要的效果，
    # 这时候可以使用 interval 配合 min、max 强制设定刻度划分，一般不建议使用。
    # 无法在类目轴中使用。在时间轴（type: 'time'）中需要传时间戳，在对数轴（type: 'log'）中需要传指数值。
    interval: Optional[Numeric] = None,

    # x 轴所在的 grid 的索引，默认位于第一个 grid。
    grid_index: Numeric = 0,

    # x 轴的位置。可选：
    # 'top', 'bottom'
    # 默认 grid 中的第一个 x 轴在 grid 的下方（'bottom'），第二个 x 轴视第一个 x 轴的位置放在另一侧。
    position: Optional[str] = None,

    # Y 轴相对于默认位置的偏移，在相同的 position 上有多个 Y 轴的时候有用。
    offset: Numeric = 0,

    # 坐标轴的分割段数，需要注意的是这个分割段数只是个预估值，最后实际显示的段数会在这个基础上根据分割后坐标轴刻度显示的易读程度作调整。 
    # 默认值是 5
    split_number: Numeric = 5,

    # 坐标轴两边留白策略，类目轴和非类目轴的设置和表现不一样。
    # 类目轴中 boundaryGap 可以配置为 true 和 false。默认为 true，这时候刻度只是作为分隔线，
    # 标签和数据点都会在两个刻度之间的带(band)中间。
    # 非类目轴，包括时间，数值，对数轴，boundaryGap是一个两个值的数组，分别表示数据最小值和最大值的延伸范围
    # 可以直接设置数值或者相对的百分比，在设置 min 和 max 后无效。 示例：boundaryGap: ['20%', '20%']
    boundary_gap: Union[str, bool, None] = None,

    # 坐标轴刻度最小值。
    # 可以设置成特殊值 'dataMin'，此时取数据在该轴上的最小值作为最小刻度。
    # 不设置时会自动计算最小值保证坐标轴刻度的均匀分布。
    # 在类目轴中，也可以设置为类目的序数（如类目轴 data: ['类A', '类B', '类C'] 中，序数 2 表示 '类C'。
    # 也可以设置为负数，如 -3）。
    min_: Union[Numeric, str, None] = None,

    # 坐标轴刻度最大值。
    # 可以设置成特殊值 'dataMax'，此时取数据在该轴上的最大值作为最大刻度。
    # 不设置时会自动计算最大值保证坐标轴刻度的均匀分布。
    # 在类目轴中，也可以设置为类目的序数（如类目轴 data: ['类A', '类B', '类C'] 中，序数 2 表示 '类C'。
    # 也可以设置为负数，如 -3）。
    max_: Union[Numeric, str, None] = None,

    # 自动计算的坐标轴最小间隔大小。
    # 例如可以设置成1保证坐标轴分割刻度显示成整数。
    # 默认值是 0
    min_interval: Numeric = 0,

    # 自动计算的坐标轴最大间隔大小。
    # 例如，在时间轴（（type: 'time'））可以设置成 3600 * 24 * 1000 保证坐标轴分割刻度最大为一天。
    max_interval: Optional[Numeric] = None,

    # 坐标轴刻度线配置项，参考 `global_options.AxisLineOpts`
    axisline_opts: Union[AxisLineOpts, dict, None] = None,

    # 坐标轴刻度配置项，参考 `global_options.AxisTickOpts`
    axistick_opts: Union[AxisTickOpts, dict, None] = None,

    # 坐标轴标签配置项，参考 `series_options.LabelOpts`
    axislabel_opts: Union[LabelOpts, dict, None] = None,

    # 坐标轴指示器配置项，参考 `global_options.AxisPointerOpts`
    axispointer_opts: Union[AxisPointerOpts, dict, None] = None,

    # 坐标轴名称的文字样式，参考 `series_options.TextStyleOpts`
    name_textstyle_opts: Union[TextStyleOpts, dict, None] = None,

    # 分割区域配置项，参考 `series_options.SplitAreaOpts`
    splitarea_opts: Union[SplitAreaOpts, dict, None] = None,

    # 分割线配置项，参考 `series_options.SplitLineOpts`
    splitline_opts: Union[SplitLineOpts, dict] = SplitLineOpts(),

    # 坐标轴次刻度线相关设置，参考 `series_options.MinorTickOpts`
    minor_tick_opts: Union[MinorTickOpts, dict, None] = None,

    # 坐标轴在 grid 区域中的次分隔线。次分割线会对齐次刻度线 minorTick，参考 `series_options.MinorSplitLineOpts`
    minor_split_line_opts: Union[MinorSplitLineOpts, dict, None] = None,
)
```



### 

